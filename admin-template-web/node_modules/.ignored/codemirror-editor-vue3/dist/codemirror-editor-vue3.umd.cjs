(function(u,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("vue"),require("codemirror/lib/codemirror.css"),require("codemirror/addon/fold/foldgutter.css"),require("codemirror/addon/fold/foldcode.js"),require("codemirror/addon/fold/foldgutter.js"),require("codemirror/addon/fold/brace-fold.js"),require("codemirror/addon/selection/active-line.js"),require("codemirror"),require("codemirror/addon/merge/merge.css"),require("codemirror/addon/merge/merge.js"),require("diff-match-patch"),require("codemirror/addon/mode/simple.js")):typeof define=="function"&&define.amd?define(["exports","vue","codemirror/lib/codemirror.css","codemirror/addon/fold/foldgutter.css","codemirror/addon/fold/foldcode.js","codemirror/addon/fold/foldgutter.js","codemirror/addon/fold/brace-fold.js","codemirror/addon/selection/active-line.js","codemirror","codemirror/addon/merge/merge.css","codemirror/addon/merge/merge.js","diff-match-patch","codemirror/addon/mode/simple.js"],t):(u=typeof globalThis<"u"?globalThis:u||self,t(u["codemirror-editor-vue3"]={},u.Vue,null,null,null,null,null,null,u.codemirror,null,null,u.DiffMatchPatch))})(this,function(u,t,ye,ke,we,_e,$e,be,L,Me,Ce,z){"use strict";!window.CodeMirror&&(window.CodeMirror=L);const M=window.CodeMirror||L,H=t.defineComponent({name:"DefaultMode",props:{name:{type:String,default:`cm-textarea-${+new Date}`},value:{type:String,default:""},content:{type:String,default:""},options:{type:Object,default:()=>({})},cminstance:{type:Object,default:()=>null},placeholder:{type:String,default:""}},emits:{ready:e=>e,"update:cminstance":e=>e},setup(e,{emit:n}){const s=t.ref(),r=t.ref(null),o=()=>{r.value=t.markRaw(M.fromTextArea(s.value,e.options)),n("update:cminstance",r.value);const a=t.watch(()=>e.cminstance,l=>{var h;l&&((h=e.cminstance)==null||h.setValue(e.value||e.content)),n("ready",t.unref(r)),a==null||a()},{deep:!0})};return t.onMounted(()=>{o()}),{textarea:s,initialize:o}}}),j=(e,n)=>{const s=e.__vccOpts||e;for(const[r,o]of n)s[r]=o;return s},P=["name","placeholder"];function U(e,n,s,r,o,a){return t.openBlock(),t.createElementBlock("textarea",{ref:"textarea",name:e.$props.name,placeholder:e.$props.placeholder},null,8,P)}const v=j(H,[["render",U]]);window.diff_match_patch=z,window.DIFF_DELETE=-1,window.DIFF_INSERT=1,window.DIFF_EQUAL=0;const W=t.defineComponent({name:"MergeMode",props:{options:{type:Object,default:()=>({})},cminstance:{type:Object,default:()=>({})}},emits:["update:cminstance","ready"],setup(e,{emit:n}){const s=t.ref(),r=t.ref(),o=()=>{s.value=t.markRaw(M.MergeView(r.value,e.options)),n("update:cminstance",s.value),n("ready",s)};return t.onMounted(()=>{o()}),{mergeView:r,initialize:o}}}),G={ref:"mergeView"};function J(e,n,s,r,o,a){return t.openBlock(),t.createElementBlock("div",G,null,512)}const Z=j(W,[["render",J]]);var T=(e=>(e.info="info",e.warning="warning",e.error="error",e))(T||{});function I(){const e=new Date,n=e.getHours()<10?`0${e.getHours()}`:e.getHours(),s=e.getMinutes()<10?`0${e.getMinutes()}`:e.getMinutes(),r=e.getSeconds()<10?`0${e.getSeconds()}`:e.getSeconds();return`${n}:${s}:${r}`}function K(e){return`#link#${JSON.stringify(e)}#link#`}function N(e){const n=/#link#(.+)#link#/g,s=[];let r;for(r=n.exec(e);r;){const o=document.createElement("a"),a=JSON.parse(r[1]),l=Object.entries(a);for(const[h,m]of l)o.setAttribute(h,m);o.className="editor_custom_link",o.innerHTML="logDownload",s.push({start:r.index,end:r.index+r[0].length,node:o}),r=n.exec(e)}return s}function Q(e="",n="info"){return`#log<${n}>log#${e}#log<${n}>log#`}function A(e){const n=[];function s(){const r=/#log<(\w*)>log#((.|\r\n|\n)*?)#log<(\w*)>log#/g;let o;for(o=r.exec(e);o;){const l=o[0].replace(/\r\n/g,`
`).split(`
`),m=o[2].replace(/\r\n/g,`
`).split(`
`),g=document.createElement("span"),i=o[1];g.className=`c-editor--log__${i}`;let f=0;for(let b=0;b<l.length;b++){const c=l[b],p=m[b],w=g.cloneNode(!1);w.innerText=p,n.push({start:o.index+f,end:o.index+f+c.length,node:w}),f=f+c.length+1}o=r.exec(e)}}return s(),n}function X(e,n){return`[${I()}] <${n}> ${e}`}function Y(e,n,s){const o=new Array(Math.max(n||15,5)).join(s||"=");return`${o}${e}${o}`}const C=[{regex:/(\[.*?\])([ \t]*)(<error>[ \t])(.+)/,token:["tag","","error.strong","error.strong"],sol:!0},{regex:/(\[.*?\])([ \t]*)(<info>)(.+)(.?)/,token:["tag","","bracket","bracket","hr"],sol:!0},{regex:/(\[.*?\])([ \t]*)(<warning>)(.+)(.?)/,token:["tag","","comment","comment","hr"],sol:!0}];M.defineSimpleMode("fclog",{start:[...C,{regex:/.*/,token:"hr"}],error:[...C,{regex:/.*/,token:"error.strong"}],info:[...C,{regex:/.*/,token:"bracket"}],warning:[...C,{regex:/.*\[/,token:"comment"}]}),M.defineSimpleMode("log",{start:[{regex:/^[=]+[^=]*[=]+/,token:"strong"},{regex:/([^\w])([A-Z][\w]*)/,token:["","string"]},{regex:/(^[A-Z][\w]*)/,token:"string"}]});const ee=t.defineComponent({name:"CodemirrorFclog",props:{value:{type:String,default:""},name:{type:String,default:`cm-textarea-${+new Date}`},options:{type:Object,default:()=>({})},cminstance:{type:Object,default:()=>({})},placeholder:{type:String,default:""}},emits:["update:cminstance","ready"],setup(e,{emit:n}){const s=t.ref(),r=t.ref(null),o=(l=e.cminstance)=>{l.getAllMarks().forEach(i=>i.clear());const m=l.getValue(),g=[].concat(N(m)).concat(A(m));for(let i=0;i<g.length;i++){const f=g[i];l.markText(l.posFromIndex(f.start),l.posFromIndex(f.end),{replacedWith:f.node})}},a=()=>{var l;r.value=t.markRaw(M.fromTextArea(s.value,e.options)),n("update:cminstance",t.unref(r)),(l=r.value)==null||l.on("change",o)};return t.watch(()=>e.cminstance,l=>{var h;l&&(o(e.cminstance),(h=e.cminstance)==null||h.setValue(e.value),n("ready",r))},{deep:!0,immediate:!0}),t.onMounted(()=>{a()}),{initialize:a,textarea:s}}}),te=["name","placeholder"];function re(e,n,s,r,o,a){return t.openBlock(),t.createElementBlock("textarea",{ref:"textarea",name:e.$props.name,placeholder:e.$props.placeholder},null,8,te)}const ne=j(ee,[["render",re]]),B={"update:value":()=>!0,change:(e,n)=>({value:e,cm:n}),input:()=>!0,ready:e=>e},oe=["changes","scroll","beforeChange","cursorActivity","keyHandled","inputRead","electricInput","beforeSelectionChange","viewportChange","swapDoc","gutterClick","gutterContextMenu","focus","blur","refresh","optionChange","scrollCursorIntoView","update"],se={...B,...(()=>{const e={};return oe.forEach(n=>{e[n]=(...s)=>s}),e})()},E={mode:"text",theme:"default",lineNumbers:!0,smartIndent:!0,indentUnit:2,styleActiveLine:!0};function ae(e){Promise.resolve().then(()=>{const n=e.getScrollInfo();e.scrollTo(n.left,n.height)})}const ce=({props:e,cminstance:n,emit:s,internalInstance:r,content:o})=>{const a=t.computed(()=>{var m;return e.merge?(m=t.unref(n))==null?void 0:m.editor():t.unref(n)}),l=()=>{const m=[];return Object.keys(r==null?void 0:r.vnode.props).forEach(g=>{if(g.startsWith("on")){const i=g.replace(g[2],g[2].toLowerCase()).slice(2);!B[i]&&m.push(i)}}),m};return{listenerEvents:()=>{a.value.on("change",i=>{const f=i.getValue();f===o.value&&f!==""||(o.value=f,s("update:value",o.value||""),s("input",o.value||" "),Promise.resolve().then(()=>{s("change",o.value,i)}),e.keepCursorInEnd&&ae(i))});const m={};l().filter(i=>!m[i]&&(m[i]=!0)).forEach(i=>{a.value.on(i,(...f)=>{s(i,...f)})})}}};function le({props:e,cminstance:n,presetRef:s}){const r=t.ref("100%"),o=t.ref("100%"),a=t.computed(()=>{var c;return e.merge?(c=t.unref(n))==null?void 0:c.editor():t.unref(n)}),l=()=>{t.nextTick(()=>{var c;(c=a.value)==null||c.refresh()})},h=c=>c?!(c&&isNaN(+c)):!1,m=(c=e.width,p=e.height)=>{var S;let w="100%",$="100%";h(c)?w=`${String(c)}px`:c&&(w=c),h(p)?$=`${String(p)}px`:p&&($=p),r.value=w,o.value=$,console.log("resize",w,$),(S=a.value)==null||S.setSize("100%","100%")},g=()=>{var p;const c=(p=a.value)==null?void 0:p.getWrapperElement();c==null||c.remove()},i=()=>{var p,w,$;const c=(p=a.value)==null?void 0:p.getDoc().getHistory();(w=s.value)==null||w.initialize(),g(),($=a.value)==null||$.getDoc().setHistory(c)},f=()=>{const c=document.querySelector(".CodeMirror-gutters");return(c==null?void 0:c.style.left.replace("px",""))!=="0"};return{reload:i,refresh:l,resize:m,destroy:g,containerWidth:r,containerHeight:o,reviseStyle:()=>{if(l(),!f())return;const c=setInterval(()=>{f()?l():clearInterval(c)},60),p=setTimeout(()=>{clearInterval(c),clearTimeout(p)},400)}}}const x=t.defineComponent({__name:"index",props:{value:{type:String,default:""},options:{type:Object,default:()=>E},globalOptions:{type:Object,default:()=>E},placeholder:{type:String,default:""},border:{type:Boolean,default:!1},width:{type:[String,Number],default:null},height:{type:[String,Number],default:null},originalStyle:{type:Boolean,default:!1},keepCursorInEnd:{type:Boolean,default:!1},merge:{type:Boolean,default:!1},name:{type:String,default:""},marker:{type:Function,default:()=>null},unseenLines:{type:Array,default:()=>[]}},emits:se,setup(e,{expose:n,emit:s}){var q,F,R;typeof Object.assign!="function"&&Object.defineProperty(Object,"assign",{value(d){if(d==null)throw new TypeError("Cannot convert undefined or null to object");const y=Object(d);for(let k=1;k<arguments.length;k++){const _=arguments[k];if(_!=null)for(const O in _)Object.prototype.hasOwnProperty.call(_,O)&&(y[O]=_[O])}return y},writable:!0,configurable:!0});const r=e,o=s,a=t.ref(null),l=t.ref(""),h=t.shallowRef(v),m=t.ref({foldGutter:!0,...E,...r.globalOptions,...r.options,gutters:[...new Set(["CodeMirror-linenumbers","CodeMirror-foldgutter",...((q=r.options)==null?void 0:q.gutters)||[]])]}),g=t.getCurrentInstance(),i=r.name||((R=(F=g==null?void 0:g.parent)==null?void 0:F.type)==null?void 0:R.name)||void 0,f=t.ref(null),b=t.computed(()=>{var d;return r.merge?(d=t.unref(a))==null?void 0:d.editor():t.unref(a)}),{refresh:c,resize:p,destroy:w,containerHeight:$,containerWidth:S,reviseStyle:fe}=le({props:r,cminstance:a,presetRef:f}),{listenerEvents:me}=ce({props:r,cminstance:a,emit:o,internalInstance:g,content:l}),V=()=>{r.unseenLines!==void 0&&r.marker!==void 0&&r.unseenLines.forEach(d=>{var k,_;const y=(k=a.value)==null?void 0:k.lineInfo(d);(_=a.value)==null||_.setGutterMarker(d,"breakpoints",y!=null&&y.gutterMarkers?null:r.marker())})},ge=d=>{var k,_;const y=(k=a.value)==null?void 0:k.getValue();d!==y&&((_=a.value)==null||_.setValue(d),l.value=d,fe()),V()},pe=()=>{me(),V(),p(r.width,r.height),o("ready",a.value),t.watch([()=>r.width,()=>r.height],([d,y])=>{p(d,y)},{deep:!0})},he=()=>{if(r.options.mode==="fclog"||r.options.mode==="log"){h.value=ne;return}if(r.merge){h.value=Z;return}h.value=v};return t.watch(()=>r.options,d=>{var y;for(const k in r.options)(y=b.value)==null||y.setOption(k,t.unref(d[k]))},{deep:!0}),t.watch(()=>r.value,d=>{ge(d)}),t.watch(()=>r.merge,he,{immediate:!0}),t.onBeforeUnmount(()=>{w()}),n({cminstance:a,resize:p,refresh:c,destroy:w}),(d,y)=>(t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(["codemirror-container",{merge:d.$props.merge,bordered:d.$props.border||d.$props.merge&&!r.originalStyle,"original-style":r.originalStyle}]),style:t.normalizeStyle({height:t.unref($),width:t.unref(S)})},[(t.openBlock(),t.createBlock(t.resolveDynamicComponent(h.value),t.mergeProps({ref_key:"presetRef",ref:f,cminstance:a.value,"onUpdate:cminstance":y[0]||(y[0]=k=>a.value=k),style:{height:"100%"}},{...d.$props,...d.$attrs,options:m.value,name:t.unref(i),content:l.value},{onReady:pe}),null,16,["cminstance"]))],6))}}),D=(e,n)=>(n&&n.options&&(x.props.globalOptions.default=()=>n.options),e.component((n==null?void 0:n.componentName)||"Codemirror",x),e),ie=window.CodeMirror||M,de=D,ue=D;function styleInject(css,ref){if(ref===void 0){ref={}}var insertAt=ref.insertAt;if(!css||typeof document==="undefined"){return}var head=document.head||document.getElementsByTagName("head")[0];var style=document.createElement("style");style.type="text/css";if(insertAt==="top"){if(head.firstChild){head.insertBefore(style,head.firstChild)}else{head.appendChild(style)}}else{head.appendChild(style)}if(style.styleSheet){style.styleSheet.cssText=css}else{style.appendChild(document.createTextNode(css))}};styleInject(`.codemirror-container {
  position: relative;
  display: inline-block;
  height: 100%;
  width: fit-content;
  font-size: 13px;
  overflow: hidden;
}
.codemirror-container.bordered {
  border: 1px solid #aaaaaa;
}

.codemirror-container .editor_custom_link {
  cursor: pointer;
  color: #1474f1;
  text-decoration: underline;
}
.codemirror-container .editor_custom_link:hover {
  color: #04b4fa;
}
.codemirror-container:not(.original-style) .CodeMirror-lines .CodeMirror-placeholder.CodeMirror-line-like {
  color: #666;
}
.codemirror-container:not(.original-style) .CodeMirror,
.codemirror-container:not(.original-style) .CodeMirror-merge-pane {
  height: 100%;
  font-family: consolas !important;
}
.codemirror-container:not(.original-style) .CodeMirror-merge,
.codemirror-container:not(.original-style) .CodeMirror-merge-right .CodeMirror {
  height: 100%;
  border: none !important;
}
.codemirror-container:not(.original-style) .c-editor--log__error {
  color: #bb0606;
  font-weight: bold;
}
.codemirror-container:not(.original-style) .c-editor--log__info {
  color: #333333;
  font-weight: bold;
}
.codemirror-container:not(.original-style) .c-editor--log__warning {
  color: #ee9900;
}
.codemirror-container:not(.original-style) .c-editor--log__success {
  color: #669600;
}
.codemirror-container:not(.original-style) .cm-header,
.codemirror-container:not(.original-style) .cm-strong {
  font-weight: bold;
}
`),u.CodeMirror=ie,u.GlobalCmComponent=de,u.InstallCodeMirror=ue,u.VueCodemirror=x,u.createLinkMark=K,u.createLog=X,u.createLogMark=Q,u.createTitle=Y,u.default=x,u.getLinkMarks=N,u.getLocalTime=I,u.getLogMark=A,u.logErrorType=T,Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
